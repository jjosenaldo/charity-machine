import 'dart:developer';
import 'dart:io';

void main() {
  HttpServer.bind('10.100.172.198', 8000).then((server) {
    server.listen((request) {
      if (request.method == 'GET' && request.uri.path == '/menu') {
        String? authorizationHeader = request.headers.value('Authorization');
        if (authorizationHeader == null) {
          request.response.statusCode = HttpStatus.unauthorized;
          request.response.write('Authorization header is missing');
          request.response.close();
          return;
        }

        String user = authorizationHeader;
        log('user: $user');

        // Hardcoded menu JSON response
        String menuJson = '''
        {"categories":[{"id":"1","name":"Café-da-manhã","imageUrl":"https://cdn-icons-png.flaticon.com/512/17/17007.png?w=740&t=st=1687356356~exp=1687356956~hmac=a4540a55808badcd35594055e49ebb6eb209f2e155eb5ea1b6de435bae2e34ab","color":4294951175,"status":0},{"id":"2","name":"Almoço","imageUrl":"https://cdn-icons-png.flaticon.com/512/6540/6540381.png","color":4283215696,"status":0},{"id":"3","name":"Jantar","imageUrl":"https://cdn-icons-png.flaticon.com/512/637/637129.png","color":4282339765,"status":0}],"items":[{"id":"30","name":"Bife","availableQuantity":4,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg/800px-001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg","categoryId":"3","machinePosition":30,"allergens":["Sódio","Vegano","Glúten","Lactose"]},{"id":"31","name":"Sanduíche de frango","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg/800px-001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg","categoryId":"1","machinePosition":30,"allergens":["Vegano","Glúten"]},{"id":"32","name":"Hamburger","availableQuantity":3,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/e/e8/Gobi_manchurian.jpg","categoryId":"2","machinePosition":60,"allergens":["Sódio","Vegano"]},{"id":"33","name":"Croissant","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Pasta_e_fagioli_rapida.jpg/800px-Pasta_e_fagioli_rapida.jpg","categoryId":"3","machinePosition":120,"allergens":["Glúten"]},{"id":"34","name":"Bife","availableQuantity":4,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg/800px-001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg","categoryId":"3","machinePosition":60,"allergens":["Vegano","Sódio"]},{"id":"35","name":"Sanduíche de frango","availableQuantity":5,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/e/e8/Gobi_manchurian.jpg","categoryId":"2","machinePosition":90,"allergens":[]},{"id":"36","name":"Croissant","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"2","machinePosition":90,"allergens":["Lactose"]},{"id":"37","name":"Sanduíche de frango","availableQuantity":5,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"1","machinePosition":90,"allergens":["Lactose","Sódio","Glúten","Vegano"]},{"id":"38","name":"Salmão grelhado","availableQuantity":4,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg/800px-001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg","categoryId":"3","machinePosition":90,"allergens":["Glúten","Sódio"]},{"id":"39","name":"Panqueca","availableQuantity":1,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"2","machinePosition":90,"allergens":["Sódio","Vegano"]},{"id":"40","name":"Salada César","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Pasta_e_fagioli_rapida.jpg/800px-Pasta_e_fagioli_rapida.jpg","categoryId":"3","machinePosition":120,"allergens":["Vegano","Glúten","Lactose","Sódio"]},{"id":"41","name":"Salada César","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"3","machinePosition":150,"allergens":["Lactose","Vegano","Sódio"]},{"id":"42","name":"Ovo","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"2","machinePosition":120,"allergens":["Glúten","Vegano"]},{"id":"43","name":"Salmão grelhado","availableQuantity":5,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Pasta_e_fagioli_rapida.jpg/800px-Pasta_e_fagioli_rapida.jpg","categoryId":"2","machinePosition":120,"allergens":["Lactose","Sódio"]},{"id":"44","name":"Macarrão","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Pasta_e_fagioli_rapida.jpg/800px-Pasta_e_fagioli_rapida.jpg","categoryId":"2","machinePosition":1,"allergens":["Lactose","Sódio","Glúten","Vegano"]},{"id":"45","name":"Salmão grelhado","availableQuantity":5,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Pasta_e_fagioli_rapida.jpg/800px-Pasta_e_fagioli_rapida.jpg","categoryId":"2","machinePosition":1,"allergens":["Lactose","Glúten"]},{"id":"46","name":"Bife","availableQuantity":4,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Pasta_e_fagioli_rapida.jpg/800px-Pasta_e_fagioli_rapida.jpg","categoryId":"1","machinePosition":1,"allergens":[]},{"id":"47","name":"Ovo","availableQuantity":5,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg/800px-001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg","categoryId":"2","machinePosition":1,"allergens":["Lactose","Sódio","Vegano","Glúten"]},{"id":"48","name":"Panqueca","availableQuantity":1,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Pasta_e_fagioli_rapida.jpg/800px-Pasta_e_fagioli_rapida.jpg","categoryId":"1","machinePosition":120,"allergens":["Glúten"]},{"id":"49","name":"Panqueca","availableQuantity":4,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"3","machinePosition":120,"allergens":["Lactose"]},{"id":"50","name":"Panqueca","availableQuantity":5,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg/800px-001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg","categoryId":"1","machinePosition":1,"allergens":["Lactose","Glúten","Vegano"]},{"id":"51","name":"Sanduíche de frango","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"2","machinePosition":1,"allergens":["Vegano","Sódio","Glúten"]},{"id":"52","name":"Salmão grelhado","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"2","machinePosition":1,"allergens":["Vegano","Glúten","Sódio"]},{"id":"53","name":"Salmão grelhado","availableQuantity":4,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"2","machinePosition":1,"allergens":["Lactose"]},{"id":"54","name":"Sanduíche de frango","availableQuantity":3,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/e/e8/Gobi_manchurian.jpg","categoryId":"1","machinePosition":120,"allergens":[]},{"id":"55","name":"Salmão grelhado","availableQuantity":3,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"1","machinePosition":1,"allergens":[]},{"id":"56","name":"Salada César","availableQuantity":4,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"2","machinePosition":1,"allergens":["Vegano","Sódio","Lactose","Glúten"]},{"id":"57","name":"Ovo","availableQuantity":1,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg/800px-001_Tacos_de_carnitas%2C_carne_asada_y_al_pastor.jpg","categoryId":"1","machinePosition":1,"allergens":["Vegano","Glúten","Sódio"]},{"id":"58","name":"Sanduíche de frango","availableQuantity":2,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"3","machinePosition":150,"allergens":["Glúten","Vegano","Sódio","Lactose"]},{"id":"59","name":"Ovo","availableQuantity":3,"imageUrl":"https://upload.wikimedia.org/wikipedia/commons/1/13/Uszka-aasica.jpg","categoryId":"3","machinePosition":1,"allergens":[]}]}
        ''';

        request.response.headers.contentType = ContentType.json;
        request.response.write(menuJson);
        request.response.close();
      } else {
        request.response.statusCode = HttpStatus.notFound;
        request.response.write('Not Found');
        request.response.close();
      }
    });
  });
}
